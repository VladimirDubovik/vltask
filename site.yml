---

- name: task by Vladimir
  user: test
  hosts: ahosts
  gather_facts: false
  vars: 
    app_port: "{{ lookup('ini', 'app_port type=properties file=./templates/settings.j2') }}"

  tasks:
    - name: creating ./config folder on remote host
      file:
        path:  ./config
        state: directory

    - name: creating ./logs folder on remote host
      file:
        path:  ./logs
        state: directory

    - name: sending text file to remote host
      template:
        src: ./templates/text.j2
        dest: ./config/text.txt        

    - name: sending settings file to remote host
      template:
        src: ./templates/settings.j2
        dest: ./config/settings.cfg

    - name: sending shell-script file to remote host
      template:
        src: ./templates/script.j2
        dest: ./script.sh
 
    - name: execute shell-script file
      command: sh ./script.sh
      register: scr

    - name: display shell-script file output
      debug:
        var: scr.stdout_lines
